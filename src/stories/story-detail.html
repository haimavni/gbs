<template>
    <require from="./stories.css"></require>

    <div css="margin-top:12px;margin-left:auto;margin-right:auto;min-height:${theme.min_height-120}px" class="container content-area">
        <div class="row" style="background-color:lightgrey;padding:10px;margin-bottom:16px;margin-right:20px;margin-left:0px;font-size:150%;padding-top:18px;">
            <h3 style="float:left;cursor:pointer;padding:0;margin:0;">
                <i class="fa undo"  t="[title]go-back" click.trigger="go_back()"></i>
            </h3>
            <h3 dir="${story_dir}" style="float: right;margin:0px;">
                ${story.name}<span if.bind="user.privileges.DEVELOPER">&nbsp;${story.id}</span>
            </h3>
            <button id="word-highlighter" if.bind="keywords && keywords.length > 0 && ! user.editing" 
                class="word-highlighter ${highlight_on}" click.trigger="toggle_highlight_on()" t="[title]stories.highlight-on">
            </button>
        </div>
        <div class="row" css="direction:${story_dir};">
            <div class="col-md-5">
                <photo-strip if.bind="has_associated_photos" source.bind="source" height.bind="220" action_key="Zoom2" style="padding:0;"
                    dir="ltr" settings.bind="{arrows:true, height:220}"></photo-strip>
                <div class="row" style="height:fit-content;font-size:150%;padding:12px;margin-top: 20px;">
                    <div if.bind="user.editing" class="col-md-5" >
                        <form class="form-inline">
                            <button class="btn btn-success btn-sm" click.trigger="update_associated_photos()" style="float:left;margin-right:5px;">
                                ${'photos.photos' & t}
                            </button>
                            <button class="btn btn-success btn-sm" click.trigger="update_associated_members()" style="float:left;">
                                ${'members.members' & t}
                            </button>
                            <label style="float:right;font-weight:normal;font-size:18px;margin-top:2px;">${'update' & t}:</label>
                        </form>
                    </div>
                    <div if.bind="! user.editing" class="col-md-5">
                    </div>
                    <div show.bind="members.length>0" class="col-md-7" style="padding-right:36px;">
                        <span style="float:right;margin-right:-10px;">${'stories.associated-members' & t}</span>
                    </div>
                </div>
                <div if.bind="members.length>0" id="member-list" class="row stories-member-list content-area" style="max-height:400px;overflow:auto;overflow-x:hidden;">
                    <ul class="list-group">
                        <li class="list-group-item" repeat.for="member of members">
                            <a route-href="route: member-details; params.bind: {id:member.id}">
                                <img src.bind="member.facePhotoURL" />
                                <h6 dir="${theme.rtltr}" class="list-group-item-heading" >${member.full_name}</h6>
                            </a>
                        </li>
                    </ul>
                </div>
                <div if.bind="user.editing && candidates.length>0" id="candidate-list" class="row stories-member-list content-area" style="max-height:400px;overflow:auto;overflow-x:hidden;">
                    <h3 style="margin-right:40px;">${'photos.candidates' & t}</h3>
                    <ul class="list-group">
                        <li class="list-group-item" repeat.for="candidate of candidates">
                            <a click.delegate="accept_candidate(candidate.id, $index)" style="cursor:pointer;">
                                <img src.bind="candidate.facePhotoURL" />
                                <h6 dir="${theme.rtltr}" class="list-group-item-heading" >${candidate.full_name}</h6>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="col-md-7 justified-story full-story" style="padding-right:36px;">
                <div class="row">
                    <div class="col-md-4 col-md-offset-8" if.bind="story.source">
                        <span css="float:right;direction:${story_dir}">${story.source}:</span>
                    </div>
                </div>
                <div class="row" style="padding-right:15px;">
                    <div class="fr-view" dir="${story_dir}">
                        <div class="big-story-panel ${theme.font_size}">
                            <p class="${story_dir} ${highlight_on}" if.bind="! user.editing"> 
                                <compose if.bind="story.story_text" view-model='./render-story' model.bind="highlightedHtml"></compose>
                            </p>
                            <editable if.bind="user.editing" 
                                settings.bind="{show_date:false, class:'story-section', checkable: false}" 
                                story.bind="story">
                            </editable>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

</template>
