<template class="multi-select">
    <require from="./multi-select.css">
    </require>
    <div class="input-group search-filter" if.bind="options.length > 10">
        <input dir="rtl" type="search" class="form-control" t="[placeholder]${place_holder_text}" value.bind="filter & debounce">
    </div>
    <div class="ms-container" css="height:${height}px;">
        <div class="row options selected" css="max-height:${height_selected}px;">
            <!-- First  display grouped options. may be add a popover with names of all group members-->
            <ul if.bind="grouped_selected_options.length>0" class="grouped" css="width:${width}px;">
                <li repeat.for="option of grouped_selected_options" class="selected" css="width:${inner_width}px;">
                    <div class="option-item" css="margin:0;padding:0;width:${inner_width}px">
                        <span class="span-a">
                            <a click.trigger="toggle_selection(option)" aubs-tooltip="text.bind:option.names; position:top;class:ms-tooltip;">
                                ${option.name}
                            </a>
                        </span>
                        <span class="span-i">
                            <a click.trigger="unmerge_options(option, $event)">
                                <i class="fa fa-paperclip fa-rotate-90 tool"></i>
                            </a>
                            <a if.bind="user.advanced && !user.editing" click.trigger="toggle_sign(option, $event)">
                                <!-- The rotatate-180 thing here and below is kind of voodoo. It is crazy without it-->
                                <i class="fa fa-${option.sign}-square-o fa-rotate-180 tool"></i>
                            </a>
                        </span>
                    </div>
                </li>
            </ul>
            <!-- Second come all ungrouped options -->
            <ul css="width:${width}px;">
                <li repeat.for="option of ungrouped_selected_options" class="selected" css="width:${inner_width}px;">
                    <div class="option-item" css="margin:0;padding:0;width:${inner_width}px">
                        <span class="span-a">
                            <a click.trigger="toggle_selection(option)">
                                ${option.name}
                            </a>
                        </span>
                        <span class="span-i">
                            <a if.bind="can_merge" click.trigger="merge_options(option, $event)">
                                <i class="fa fa-paperclip fa-rotate-90 tool"></i>
                            </a>
                            <a if.bind="can_edit || user.advanced" click.trigger="toggle_sign(option, $event)">
                                <i class="fa fa-${option.sign}-square-o fa-rotate-180 tool"></i>
                            </a>
                            <a if.bind="can_edit" click.trigger="edit_option(option, $event)">
                                <i class="fa fa-pencil fa-rotate-180 fa-rotate-180 tool"></i>
                            </a>
                            <a if.bind="can_edit" click.trigger="remove_option(option, $event)">
                                <i class="fa fa-trash fa-rotate-180 tool"></i>
                            </a>
                        </span>
                    </div>
                </li>
            </ul>
        </div>
        <!-- Under the line come all unselected options -->
        <div class="row options unselected" css="max-height:${height_unselected}px;" if.bind="options && options.length > 0">
            <ul css="width:${width}px;" if.bind="true || unselected_options===[]">
                <li repeat.for="option of options | filter: filter : 'name' | filterBySet : all_selected | take : 199">
                    <div class="option-item" css="margin:0;padding:0;width:${inner_width}px">
                        <a click.trigger="toggle_selection(option)">${option.name}</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>

</template>