<template class="multi-select">
    <require from="./multi-select.css">
    </require>
    <div class="input-group search-filter" if.bind="options.length > 0">
        <search-input value.bind="filter" placeholder.bind="place_holder_text" height="32" filter-change.delegate="enter_word($event)"></search-input>
    </div>

    <div class="ms-container" css="height:${total_height}px;position:relative">
        <button if.bind="can_add  && ! filter" 
            style="position:absolute;top:60px;left:140px;padding:0;" 
            class="btn btn-success btn-xs cl-create-btn">
            <dlg-string str.bind="new_item_name" 
                placeholder.bind="new_item_placeholder" 
                anchor.bind="anchor"
                str-change.delegate="handle_new_item($event)"
                title.bind="new_item_title">
            </dlg-string>
        </button>
        <!-- list of selected options -->
        <div class="row options selected">
            <div show.bind="clear_selections" ></div>
            <ul css="padding-right:0;max-height:${settings.height_selected}px;overflow:auto;" ref="scroll_area">
                <li repeat.for="item of selected_options" class="${item.group_number % 2 ? 'odd-group' : 'even-group'}">
                    <div class="option-item" css="margin:0;padding:0;width:${inner_width}px;width:100%;height:24px;position:relative;">
                        <!-- lock/unlock button -->
                        <i class="far fa-${item.group_number==open_group ? 'lock-open-alt' : 'lock-alt'} tool" 
                            if.bind="settings.can_group && item.first"
                            t="[title]multi-select.lock-unlock" 
                            style="position:absolute;left:0;top:4px;"
                            click.delegate="toggle_group(item.group_number)">
                        </i>
                        <i class="far fa-${item.option.sign}-square fa-rotate-180 tool"
                            if.bind="settings.can_set_sign && item.first" 
                            t="[title]multi-select.change-sign"
                            style="position:absolute;left:18px;top:4px;"
                            click.delegate="toggle_sign(item.option, $event)">
                        </i>
                        <i class="far fa-times-circle tool"
                            t="[title]multi-select.unselect"
                            style="position:absolute;left:34px;top:4px;"
                            click.delegate="unselect_item(item, $index)">
                        </i>
                        <i class="far fa-exchange-alt tool"
                            t="[title]multi-select.change-group"
                            show.bind="item.moveable"
                            style="position:absolute;left:50px;top:4px;"
                            click.delegate="move_item(item, $index)">
                        </i>
                        <i class="far fa-pencil fa-rotate-180 fa-rotate-180 tool"
                            if.bind="can_edit_name"
                            t="[title]multi-select.edit-item"
                            style="position:absolute;left:66px;top:4px;"
                            click.trigger="edit_option(item, $event)">
                        </i>
                        <i class="far fa-trash-alt tool"
                            if.bind="can_delete"
                            t="[title]multi-select.remove-item"
                            style="position:absolute;left:82px;top:4px;"
                            click.delegate="remove_option(item, $event, $index)">
                        </i>
                        <span if.bind="! item.editing" style="height:24px;padding-right:5px;" class.bind="item.option.is_group ? 'option-group' : ''">${item.option.name}</span>
                        <input type="text" if.bind="item.editing" value.bind="item.option.name" change.delegate="name_changed(item, $event)" style="width:55%" >
                    </div>
                </li>
            </ul>
        </div>

        <!-- unselected options -->
        <div class="row options unselected" 
            css="max-height:${option_list_height}px;" 
            if.bind="options && options.length > 0 && (filter.length > 0 || (! settings.show_only_if_filter)) ">
            <ul css="width:${width}px;" if.bind="true || unselected_options===[]">
                <li repeat.for="option of options | filter: filter : 'name' | filterBySet : selected_options_set : 'exclude' | take : 999">
                    <div class="option-item" css="margin:0;padding:0;padding-right:2px;width:${inner_width}px">
                        <a click.delegate="select_option(option)"  class.bind="option.is_group ? 'option-group' : ''">${option.name}</a>
                    </div>
                </li>
            </ul>
        </div>
    </div>

</template>
