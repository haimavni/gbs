<template>
    <require from="./members.css"></require>
    <div style="margin-top:50px" class="content-area">
        <div class="row" style="background-color:lightgrey;padding:10px;margin-bottom:0px;margin-right:0px;margin-left:0px;font-size:150%;padding-top:18px;"
            <h3 dir="rtl" style="float: right;margin:0px;">
            <span if.bind="member.member_info.id">${member.member_info.full_name }</span>
            <span if.bind="! member.member_info.id">${'members.new-member' | t }</span>
            </h3>
        </div>
        <photo-strip source.bind="source" height.bind="220" id.bind="member.member_info.id" action_key="Zoom"
            settings.bind="{arrows:true, height:220}"></photo-strip>
        <div>
            <div class="row content-area" style="min-height:280px;width:1170px;margin: 0;" dir="rtl">
                <div class="col-md-6">
                    <div class="row" if.bind="member.family_connections.hasFamilyConnections">
                        <h3>${'members.family-connections' & t}</h3>
                    </div>
                    <div class="row family-chains">
                        <table class="noborder">
                            <tr if.bind="member.family_connections.parents && (member.family_connections.parents.pa || member.family_connections.parents.ma)">
                                <td class="relation-kind">${'parents' & t}</td>
                                <td>
                                    <ul class="family">
                                        <li>
                                            <a type="button" class="btn btn-default ${disabled_if}" if.bind="member.family_connections.parents && member.family_connections.parents.pa"
                                                route-href="route: member-details; params.bind: {id:member.family_connections.parents.pa.id}" style="float:right;">
                                                <img src.bind="get_profile_photo(member.family_connections.parents.pa)" />
                                                <span>
                                                    ${member.family_connections.parents.pa.name}
                                                </span>
                                            </a>
                                            <a type="button" class="btn btn-default ${disabled_if}" if.bind="member.family_connections.parents && member.family_connections.parents.ma"
                                                route-href="route: member-details; params.bind: {id:member.family_connections.parents.ma.id}" style="float:right;">
                                                <img src.bind="get_profile_photo(member.family_connections.parents.ma)" />
                                                <span>
                                                    ${member.family_connections.parents.ma.name}
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr if.bind="member.family_connections.siblings.length > 0">
                                <td class="relation-kind">${'siblings' & t}</td>
                                <td>
                                    <ul class="family">
                                        <li>
                                            <a type="button" class="btn btn-default ${disabled_if}" 
                                                repeat.for="sibling of member.family_connections.siblings" route-href="route: member-details; params.bind: {id:sibling.id}">
                                                <img src.bind="get_profile_photo(sibling)" />
                                                <span>
                                                    ${sibling.name}
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr if.bind="member.family_connections.spouses.length > 0">
                                <td class="relation-kind">${member.spouses & t}</td>
                                <td>
                                    <ul class="family">
                                        <li>
                                            <a type="button" class="btn btn-default ${disabled_if}" repeat.for="spouse of member.family_connections.spouses" route-href="route: member-details; params.bind: {id:spouse.id}">
                                                <img src.bind="get_profile_photo(spouse)" />
                                                <span>
                                                    ${spouse.name}
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                            <tr if.bind="member.family_connections.children.length> 0">
                                <td class="relation-kind">${'children' & t}</td>
                                <td>
                                    <ul class="family">
                                        <li>
                                            <a type="button" class="btn btn-default ${disabled_if}" repeat.for="child of member.family_connections.children" route-href="route: member-details; params.bind: {id:child.id}">
                                                <img src.bind="get_profile_photo(child)" />
                                                <span>
                                                    ${child.name}
                                                </span>
                                            </a>
                                        </li>
                                    </ul>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <div class="col-md-6" if.bind="user.editing && member" style="padding-right:32px;">
                    <div class="row" dir="rtl">
                        <compose view-model="./member-edit" model.bind="member"></compose>
                    </div>
                </div>
                <div class="col-md-6 fr-view" style="margin-bottom:16px;padding-left:20px;" if.bind="(user.privileges.EDITOR || story_0.story_text != '') && ! user.editing"
                    )>
                    <h4 innherhtml.bind="story_0.topic" style="margin-top:16px;margin-bottom:0px;color:gray;">
                        ${'members.life-summary' | t} ${member.member_info.first_name}
                    </h4>
                    <h3 show.bind="story_0.name || story_0.topic" dir="rtl" style="padding:0;margin:0;margin-bottom:8px;">
                        <i class="fa fa-expand fa-xs is-link" t="[title]stories.zoom" click.trigger="zoom_out(story_0, 'show')">&nbsp;&nbsp;</i>
                        <i if.bind="user.privileges.EDITOR" class="fa fa-pencil is-link" t="[title]stories.edit" click.trigger="zoom_out(story_0, 'edit', 'life')">&nbsp;</i>
                        ${story_0.name}
                    </h3>
                    <div class="member-story-panel" style="border-left:solid 2px darkgray;">
                        <p dir="rtl" innerhtml.bind="story_0.story_text ">
                        </p>
                    </div>
                </div>
            </div>
            <div class="row fr-view slide-list" if.bind="! user.editing" interact-draggable interact-dragend.delegate="shift_stories($event)"
                dir="rtl" style="padding-right:15px;border: solid 6px white;">
                <div if.bind="stories_scroll" class="slide-control next" click.trigger="next_story($event, -1)"><i class="fa fa-chevron-right fa-3x"></i></div>
                <div if.bind="stories_scroll" class="slide-control prev" click.trigger="next_story($event, +1)"><i class="fa fa-chevron-left fa-3x"></i></div>

                <div class="col-md-3 story-box last notfirst" show.bind="story_4.story_text != ''">
                    <h4 show.bind="story_4.name" dir="rtl">
                        <i class="fa fa-expand fa-xs is-link" t="[title]stories.zoom" click.trigger="zoom_out(story_4, 'show')">&nbsp;</i>
                        <i if.bind="user.privileges.EDITOR" class="fa fa-pencil is-link" t="[title]stories.edit" click.trigger="zoom_out(story_4, 'edit')">&nbsp;</i>
                        <span innerhtml.bind="story_4.name"></span>
                    </h4>
                    <div class="member-story-panel">
                        <p dir="rtl" innerhtml.bind="story_4.story_text ">
                        </p>
                    </div>
                </div>
                <div class="col-md-3 story-box notfirst" show.bind="story_3.story_text != ''">
                    <h4 show.bind="story_3.name" dir="rtl">
                        <i class="fa fa-expand fa-xs is-link" t="[title]stories.zoom" click.trigger="zoom_out(story_3, 'show')">&nbsp;</i>
                        <i if.bind="user.privileges.EDITOR" class="fa fa-pencil is-link" t="[title]stories.edit" click.trigger="zoom_out(story_3, 'edit')">&nbsp;</i>
                        <span innerhtml.bind="story_3.name"></span>
                    </h4>
                    <div class="member-story-panel">
                        <p dir="rtl" innerhtml.bind="story_3.story_text ">
                        </p>
                    </div>
                </div>
                <div class="col-md-3 story-box notfirst" show.bind="story_2.story_text != ''" >
                    <h4 show.bind="story_2.name" dir="rtl" >
                        <i class="fa fa-expand fa-xs is-link" t="[title]stories.zoom" click.trigger="zoom_out(story_2, 'show')">&nbsp;&nbsp;</i>
                        <i if.bind="user.privileges.EDITOR" class="fa fa-pencil is-link" t="[title]stories.edit" click.trigger="zoom_out(story_2, 'edit')">&nbsp;</i>
                        <span innerhtml.bind="story_2.name"></span>
                    </h4>
                    <div class="member-story-panel">
                        <p dir="rtl" innerhtml.bind="story_2.story_text ">
                        </p>
                    </div>
                </div>
                <div class="col-md-3 story-box" show.bind="story_1.story_text != '' || user.privileges.EDITOR">
                    <h4 show.bind="story_1.name" dir="rtl">
                        <i class="fa fa-expand fa-xs is-link" t="[title]stories.zoom" click.trigger="zoom_out(story_1, 'show')">&nbsp;&nbsp;</i>
                        <i if.bind="user.privileges.EDITOR" class="fa fa-pencil is-link" t="[title]stories.edit" click.trigger="zoom_out(story_1, 'edit')">&nbsp;</i>
                        <span innerhtml.bind="story_1.name"></span>
                    </h4>
                    <div class="member-story-panel">
                        <p dir="rtl" innerhtml.bind="story_1.story_text">
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

</template>