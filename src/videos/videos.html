<template>
    <require from="./videos.css"></require>
    <section class="container content-area photos" css="height: ${win_height-304}px;">
        <div class="video-page row content-area">
            <div class="row">
                <div class="col-md-9">
                    <div class="row" style="margin-bottom:15px;">
                        <div class="col-md-1 paging-buttons" dir="ltr">
                            <button t="[title]videos.prev" class="btn btn-default" click.delegate="page(-1, $event)" disabled.bind="prev_disabled"><i class="fas fa-chevron-left"></i></button>
                            <button t="[title]videos.next" class="btn btn-default" click.delegate="page(+1, $event)" disabled.bind="next_disabled"><i class="fas fa-chevron-right"></i></button>
                        </div>
                        <div class="col-md-10 col-md-offset-1 ctrls-group">
                            <div class="input-group row" style="width:40%;margin-left:20px;">
                                <search-input value.bind="filter" placeholder="videos.filter" height="38"></search-input>
                            </div>
                            <div if.bind="phase=='photos-ready-to-edit'" class="ctrl">
                                <button click.delegate="new_video()" class="btn btn-success cl-create-btn">
                                    <i class="far fa-plus-square"></i>
                                    ${'videos.new' & t}
                                </button>
                            </div>
                            <div if.bind="phase=='videos-were-selected'" class="ctrl">
                                <button 
                                    disabled.bind="params.selected_topics.length==0 && params.selected_photographers.length != 1 && params.videos_date_datestr == ''"
                                    class="btn btn-default btn-md" 
                                    click.trigger="apply_to_selected()">
                                    ${'photos.apply-to-selected' & t}
                                </button>
                                <help topic="apply-to-selected-photos" position="bottom"></help>
                            </div>
                            <div class="ctrl" if.bind="phase=='can-modify-tags'">
                                <button 
                                    class="btn btn-default btn-md" 
                                    click.trigger="save_merges($event)">
                                    ${'photos.save-merges' & t}
                                </button>
                                <help topic="photos.can-modify-tags", position="bottom"></help>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="video-panel" ref="scroll_area">
                            <span repeat.for="video of video_list | filter: filter : '*selected' : 'name' | keeplen : length_keeper | take : videos_per_page : first_index" class="fr-video fr-fvc fr-draggable fr-dvi"
                                
                                contenteditable="false" draggable="true">
                                <iframe class="video-iframe" src.bind="video.src" frameborder="0" allowfullscreen="">
                                </iframe>
                                <span class="video-name" style="margin-top:-6px;">
                                    <span if.bind="user.editing">
                                        <i class="fa${video.selected ? 's' : 'r'} fa-circle" click.delegate="toggle_selection(video)"></i>
                                        <i class="far fa-trash-alt" click.delegate="delete_video(video)"></i>
                                        <i class="far fa-pencil" click.delegate="edit_video_info(video)"></i>
                                    </span>
                                    <span>
                                        <info title.bind="video_info_title(video)" content.bind="video.video_info_content" style="margin-right:-8px;"></info>
                                    </span>
                                    ${video.name}
                                </span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="col-md-3">
                    <span show.bind="false">${user_editing}</span>
                    <div class="row" style="margin-bottom:15px;position:relative;">
                        <help topic="tags" position="bottom" style="position:absolute;left:2px;top:2px;"></help>
                        <multi-select options.bind="topic_list"
                            selected_options.bind="params.selected_topics"
                            settings.bind="options_settings"
                            has_groups.bind="has_grouped_topics"
                            name="topics"
                            place_holder_text="photos.click-topic"
                            clear_selections_now.bind="clear_selected_topics_now"
                            ms-change.delegate="handle_topic_change($event) ">
                        </multi-select>
                    </div>
                    <div class="row">
                        <multi-select options.bind="photographer_list"
                            place_holder_text="photos.click-photographer"
                            selected_options.bind="params.selected_photographers"
                            settings.bind="photographers_settings"
                            has_groups.bind="has_grouped_photographers"
                            new-name.delegate="add_photographer($event)"
                            remove-option.delegate="remove_photographer($event)"
                            name-changed.delegate="photographer_name_changed($event)"
                            clear_selections_now.bind="clear_selected_phototgraphers_now"
                            ms-change.delegate="handle_photographer_change($event)">
                        </multi-select>
                    </div>
                </div>
            </div>
        </div>
    </section>
</template>
